{"version":3,"file":null,"sources":["../../src/components/Share/Share.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Button, Modal, Select, Row, Col, Icon } from 'antd'\nconst Option = Select.Option\n\nclass Share extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      visible: false,\n      value: '',\n      shares: [],\n    }\n    this.showModal = this.showModal.bind(this)\n    this.handleOk = this.handleOk.bind(this)\n    this.handleCancel = this.handleCancel.bind(this)\n    this.handleSelectChange = this.handleSelectChange.bind(this)\n    this.addShare = this.addShare.bind(this)\n    this.deleteItem = this.deleteItem.bind(this)\n  }\n\n  componentWillReceiveProps (nextProps) {\n    if (nextProps.loading !== this.props.loading) {\n      this.setState({ visible: nextProps.loading, loading: nextProps.loading })\n    }\n    if (nextProps.loading !== this.props.loading && !nextProps.loading) {\n      this.setState({ shares: [] })\n    }\n  }\n\n  showModal () {\n    this.setState({ visible: true })\n  }\n\n  handleOk () {\n    this.props.share && this.props.share(this.state.shares)\n  }\n\n  handleCancel () {\n    this.setState({ visible: false, shares: [], loading: false })\n  }\n\n  handleSelectChange (val) {\n    this.setState({ value: val })\n  }\n\n  addShare () {\n    const filter = (arr) => {\n      const seen = new Map()\n      return arr.filter((a) => !seen.has(a) && seen.set(a, 1))\n    }\n    this.setState({ shares: filter(this.state.shares.concat(this.state.value)) })\n\n    console.info(filter(this.state.shares.concat(this.state.value)))\n  }\n\n  deleteItem (val) {\n    const newArr = this.state.shares.filter(n => n !== val)\n    this.setState({ shares: newArr })\n  }\n\n  render () {\n    const { visible, value, shares } = this.state\n    const { title, list, loading, type, size } = this.props\n    const item = {\n      display: 'block',\n      whiteSpace: 'nowarp',\n      overflow: 'hidden',\n      lineHeight: '20px',\n    }\n    const text = {\n      display: 'block',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      width: '90%',\n      float: 'left',\n    }\n    const btn = {\n      float: 'right',\n    }\n    const container = {\n      maxHeight: '50vh',\n      overflow: 'hidden',\n      overflowY: 'auto',\n    }\n    return (\n      <span>\n        <Button type={type || 'default'} size={size || 'default'} onClick={this.showModal}>\n          <Icon type='share-alt' />分享\n        </Button>\n        <Modal\n          title={title || ''}\n          visible={visible}\n          onOk={this.handleOk}\n          onCancel={this.handleCancel}\n          width='100vh'\n          footer={[\n            <Button key='back' size='small' onClick={this.handleCancel}>取消</Button>,\n            <Button key='submit' type='primary' size='small' loading={loading} onClick={this.handleOk}>\n              确定\n            </Button>,\n          ]}\n        >\n          <Row>\n            <Col span={8}><div style={{ textAlign: 'right', padding: '10px' }}>分享:</div></Col>\n            <Col span={8}>\n              <div style={{ padding: '10px' }}>\n                <ul style={container}>\n                  {\n                    shares.map((sh) => {\n                      return <li style={item} key={sh}>\n                        <span style={text}>{sh}</span>\n                        <a style={btn} onClick={() => { this.deleteItem(sh) }}><Icon type='delete' /></a>\n                      </li>\n                    })\n                  }\n                </ul>\n              </div>\n            </Col>\n          </Row>\n          <Row>\n            <Col span={8}><div style={{ textAlign: 'right', padding: '10px' }}>添加分享:</div></Col>\n            <Col span={16}>\n              <div style={{ padding: '10px' }}>\n                <Select\n                  showSearch\n                  style={{ width: 200 }}\n                  placeholder='Select a person'\n                  optionFilterProp='children'\n                  onChange={this.handleSelectChange}\n                  value={value}\n                  filterOption={(input, option) => option.props.value.toLowerCase().indexOf(input.toLowerCase()) >= 0}\n                >\n                  {\n                    list && list instanceof Array &&\n                    list.map((op) => {\n                      return <Option value={op} key={op}>{op}</Option>\n                    })\n                  }\n                </Select>\n                &nbsp;&nbsp;\n                <Button onClick={this.addShare} disabled={!value}><Icon type='plus' />添加</Button>\n              </div>\n            </Col>\n          </Row>\n        </Modal>\n      </span>\n    )\n  }\n}\n\nShare.propTypes = {\n  // form: PropTypes.object,\n  list: PropTypes.array,\n  share: PropTypes.func,\n  title: PropTypes.string,\n  loading: PropTypes.bool,\n  type: PropTypes.string,\n  size: PropTypes.string,\n}\n\nexport default Share\n"],"names":["Option","Select","Share","props","state","showModal","bind","handleOk","handleCancel","handleSelectChange","addShare","deleteItem","nextProps","loading","setState","visible","shares","share","val","value","filter","arr","seen","Map","a","has","set","concat","info","newArr","n","title","list","type","size","item","text","btn","container","Icon","textAlign","padding","map","sh","width","input","option","toLowerCase","indexOf","Array","op","React","Component","propTypes","PropTypes","array","func","string","bool"],"mappings":"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"}